<%- include('../partials/head.ejs', { 
    title: title || 'Specification Details',
    description: seoDescription,
    url: currentUrl,
    image: model.model_image,
    author: authorName,
    publishedTime: publishedDateISO,
    type: 'article'
}) %>

<style>
    :root {
        --primary-red: #dc2626;
        --dark-red: #b91c1c;
        --primary-blue: #3b82f6;
        --dark-blue: #1d4ed8;
        --dark-bg: #000000;
        --card-bg: #111111;
        --text-light: #e5e5e5;
        --text-muted: #9ca3af;
    }
    
    * {
        font-family: 'Poppins', sans-serif;
    }
    
    body {
        font-family: 'Poppins', sans-serif;
        background: var(--dark-bg);
        color: white;
    }
    
    .specs-content img {
        max-width: 100%;
        height: auto;
        border-radius: 8px;
        margin: 1rem 0;
    }
    
    .specs-content p {
        margin-bottom: 1.5rem;
        line-height: 1.7;
        color: var(--text-light);
        font-size: 1.1rem;
        font-family: 'Poppins', sans-serif;
        text-align: justify;
    }
    
    .specs-content h2 {
        color: #ffffff;
        margin: 2rem 0 1rem 0;
        font-weight: 600;
        font-size: 1.75rem;
        position: relative;
        padding-bottom: 0.5rem;
        font-family: 'Poppins', sans-serif;
        counter-increment: spec-list;
    }
    
    .specs-content h2::before {
        content: counter(spec-list) ". ";
        color: var(--primary-red);
        font-weight: bold;
        margin-right: 0.5rem;
    }
    
    .specs-content h2::after {
        content: "";
        position: absolute;
        bottom: 0;
        left: 0;
        width: 60px;
        height: 3px;
        background: linear-gradient(to right, var(--primary-red), var(--dark-red));
        border-radius: 2px;
    }
    
    .spec-image {
        position: relative;
        border-radius: 8px;
        overflow: hidden;
        margin: 1.5rem 0;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
    }
    
    .image-source-badge {
        position: absolute;
        bottom: 10px;
        right: 10px;
        background: rgba(0, 0, 0, 0.8);
        color: white;
        padding: 6px 12px;
        border-radius: 6px;
        font-size: 0.75rem;
        cursor: pointer;
        text-decoration: none;
        transition: all 0.3s ease;
        backdrop-filter: blur(5px);
        border: 1px solid rgba(255, 255, 255, 0.1);
        font-weight: 500;
        font-family: 'Poppins', sans-serif;
    }
    
    .image-source-badge:hover {
        background: rgba(220, 38, 38, 0.9);
        transform: translateY(-2px);
    }
    
    .content-block {
        margin-bottom: 2rem;
    }
    
    .action-buttons {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 3rem;
        padding-top: 2rem;
        border-top: 1px solid #374151;
    }
    
    /* Enhanced Share Button */
    .share-btn {
        padding: 0.85rem 1.75rem;
        border-radius: 8px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        border: none;
        font-size: 1rem;
        display: flex;
        align-items: center;
        gap: 0.75rem;
        background: linear-gradient(135deg, var(--primary-blue), var(--dark-blue));
        color: white;
        position: relative;
        overflow: hidden;
        font-family: 'Poppins', sans-serif;
    }
    
    .share-btn::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
        transition: left 0.5s;
    }
    
    .share-btn:hover {
        transform: translateY(-3px);
    }
    
    .share-btn:hover::before {
        left: 100%;
    }
    
    .back-to-model {
        padding: 0.85rem 1.75rem;
        border-radius: 8px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        border: none;
        font-size: 1rem;
        display: flex;
        align-items: center;
        gap: 0.75rem;
        background: linear-gradient(135deg, var(--primary-red), var(--dark-red));
        color: white;
        text-decoration: none;
        font-family: 'Poppins', sans-serif;
    }
    
    .back-to-model:hover {
        transform: translateY(-3px);
    }
    
    .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.85);
        z-index: 1000;
        justify-content: center;
        align-items: center;
        backdrop-filter: blur(5px);
    }
    
    .modal-content {
        background: #1f2937;
        border-radius: 12px;
        padding: 2rem;
        max-width: 500px;
        width: 90%;
        border: 1px solid #374151;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
        animation: modalFadeIn 0.3s ease-out;
    }
    
    @keyframes modalFadeIn {
        from {
            opacity: 0;
            transform: translateY(-20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
    
    .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1.5rem;
        padding-bottom: 1rem;
        border-bottom: 1px solid #374151;
    }
    
    .modal-title {
        font-size: 1.5rem;
        font-weight: 600;
        color: white;
        font-family: 'Poppins', sans-serif;
    }
    
    .close-btn {
        background: none;
        border: none;
        color: #9ca3af;
        font-size: 1.5rem;
        cursor: pointer;
        padding: 0;
        width: 36px;
        height: 36px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 50%;
        transition: all 0.2s ease;
    }
    
    .close-btn:hover {
        background: #374151;
        color: white;
        transform: rotate(90deg);
    }
    
    .share-icons {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 0.75rem;
        margin-bottom: 1.5rem;
    }
    
    .share-icon {
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 1rem;
        background: #374151;
        border-radius: 10px;
        cursor: pointer;
        transition: all 0.3s ease;
        border: none;
        color: white;
        position: relative;
        overflow: hidden;
    }
    
    .share-icon::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), transparent);
        opacity: 0;
        transition: opacity 0.3s;
    }
    
    .share-icon:hover {
        background: #4b5563;
        transform: translateY(-3px);
    }
    
    .share-icon:hover::before {
        opacity: 1;
    }
    
    .share-icon svg {
        width: 24px;
        height: 24px;
    }
    
    .copy-link {
        width: 100%;
        padding: 1rem;
        background: #374151;
        border: 1px solid #4b5563;
        border-radius: 8px;
        color: white;
        display: flex;
        justify-content: space-between;
        align-items: center;
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 0.9rem;
        font-weight: 500;
        font-family: 'Poppins', sans-serif;
    }
    
    .copy-link:hover {
        background: #4b5563;
        transform: translateY(-2px);
    }
    
    .author-date {
        display: flex;
        align-items: center;
        gap: 1rem;
        margin: 1rem 0 2rem 0;
        color: var(--text-muted);
        font-size: 0.95rem;
        font-family: 'Poppins', sans-serif;
    }
    
    .author-name {
        color: var(--text-light);
        font-weight: 600;
        cursor: pointer;
        text-decoration: none;
        transition: color 0.3s ease;
        font-family: 'Poppins', sans-serif;
    }
    
    .author-name:hover {
        color: #dc2626 !important;
    }
    
    .separator {
        color: #6b7280;
    }
    
    .spec-title {
        font-size: 2.75rem;
        font-weight: 800;
        color: white;
        line-height: 1.2;
        margin-bottom: 1rem;
        background: linear-gradient(to right, #ffffff, #e5e5e5);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        font-family: 'Poppins', sans-serif;
    }
    
    .content-link {
        color: #60a5fa;
        text-decoration: none;
        font-weight: 500;
        position: relative;
        padding-bottom: 2px;
        font-family: 'Poppins', sans-serif;
    }
    
    .content-link::after {
        content: "";
        position: absolute;
        bottom: 0;
        left: 0;
        width: 0;
        height: 2px;
        background: #60a5fa;
        transition: width 0.3s ease;
    }
    
    .content-link:hover {
        color: #3b82f6;
    }
    
    .content-link:hover::after {
        width: 100%;
    }
    
    /* Recommended Models Box Styles */
    .recommended-model-box {
        border-radius: 12px;
        background: linear-gradient(to bottom, var(--primary-red), var(--dark-bg));
        padding: 12px;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        border: 1px solid rgba(255, 255, 255, 0.05);
    }
    
    .spec-recommendation-box {
        border-radius: 8px;
        background: #1f2937;
        padding: 1rem;
        margin-bottom: 1rem;
        border-left: 4px solid var(--primary-red);
        transition: all 0.3s ease;
    }
    
    .spec-recommendation-box:hover {
        background: #374151;
        transform: translateX(5px);
    }
    
    /* Desktop Layout */
    @media (min-width: 1024px) {
        .main-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 3rem;
            align-items: start;
        }
        
        .specs-content {
            grid-column: 1;
        }
        
        .recommendations-sidebar {
            grid-column: 2;
            position: sticky;
            top: 2rem;
        }
    }
    
    /* Mobile Layout */
    @media (max-width: 1023px) {
        .main-grid {
            display: flex;
            flex-direction: column;
        }
        
        .recommendations-sidebar {
            order: 2;
            margin-top: 3rem;
        }
        
        .specs-content {
            order: 1;
        }
        
        .spec-title {
            font-size: 2rem;
        }
        
        .action-buttons {
            flex-direction: column;
            gap: 1rem;
        }
        
        .back-to-model, .share-btn {
            width: 100%;
            justify-content: center;
        }
    }
    
    .line-clamp-3 {
        display: -webkit-box;
        -webkit-line-clamp: 3;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }
    
    .justified-text {
        text-align: justify;
    }
    
    /* Counter for specification lists */
    .specs-content {
        counter-reset: spec-list;
    }
</style>
</head>
<body class="min-h-screen flex flex-col bg-black text-white" itemscope itemtype="https://schema.org/Article">
    
<!-- Schema.org Structured Data -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "TechArticle",
  "headline": "<%= specification.title %> of <%= model.brand_name %> <%= model.model_name %> in Nepal",
  "description": "<%= seoDescription %>",
  "image": "<%= model.model_image %>",
  "datePublished": "<%= publishedDateISO %>",
  "dateModified": "<%= publishedDateISO %>",
  "author": {
    "@type": "Person",
    "name": "<%= authorName %>"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Auto Specifications",
    "logo": {
      "@type": "ImageObject",
      "url": "https://yourwebsite.com/logo.png"
    }
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "<%= currentUrl %>"
  }
}
</script>

<%- include('../partials/navbar') %>

<!-- Main Content -->
<main class="flex-grow container mx-auto px-4 py-8 max-w-7xl">
    <!-- Breadcrumb Schema -->
    <nav class="mb-6" aria-label="Breadcrumb">
        <ol class="flex items-center space-x-2 text-sm text-gray-400" itemscope itemtype="https://schema.org/BreadcrumbList">
            <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
                <a href="/" class="hover:text-red-500 transition" itemprop="item">
                    <span itemprop="name">Home</span>
                </a>
                <meta itemprop="position" content="1" />
            </li>
            <li>></li>
            <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
                <a href="/modeldetails/<%= model.id %>" class="hover:text-red-500 transition" itemprop="item">
                    <span itemprop="name"><%= model.brand_name %> <%= model.model_name %></span>
                </a>
                <meta itemprop="position" content="2" />
            </li>
            <li>></li>
            <li class="text-white truncate max-w-xs" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
                <span itemprop="name"><%= specification.title %></span>
                <meta itemprop="position" content="3" />
            </li>
        </ol>
    </nav>

    <!-- Main Grid Layout -->
    <div class="main-grid">
        <!-- Left Side - Specification Content -->
        <div class="specs-content">
            <!-- Specification Header -->
            <article class="mb-8">
                <!-- Specification Title -->
                <h1 class="spec-title" itemprop="headline">
                    <%= specification.title %> of <%= model.brand_name %> <%= model.model_name %> in Nepal
                </h1>

                <!-- Author and Date -->
                <div class="author-date">
                    <% if (model.author_id) { %>
                    <a href="/profile/<%= model.author_id %>" class="author-name" itemprop="author" itemscope itemtype="https://schema.org/Person">
                        <span itemprop="name"><%= authorName %></span>
                    </a>
                    <% } else { %>
                    <span class="author-name" itemprop="author" itemscope itemtype="https://schema.org/Person">
                        <span itemprop="name"><%= authorName %></span>
                    </span>
                    <% } %>
                    <span class="separator">|</span>
                    <time datetime="<%= publishedDateISO %>" itemprop="datePublished">
                        <%= publishedDate %>
                    </time>
                </div>
            </article>

            <!-- Specification Content -->
            <section class="specs-content mb-8" itemprop="articleBody">
                <% if (specificationLists && specificationLists.length > 0) { %>
                    <% specificationLists.forEach((list, listIndex) => { %>
                        <!-- Specification List Title as H2 with numbering -->
                        <h2>
                            <%= list.title %> of <%= model.brand_name %> <%= model.model_name %> in Nepal
                        </h2>
                        
                        <!-- Specification List Contents -->
                        <% const listContents = specContents.filter(content => content.list_id === list.id); %>
                        <% if (listContents.length > 0) { %>
                            <% listContents.forEach((content, contentIndex) => { %>
                                <div class="content-block">
                                    <% if (content.type === 'article') { %>
                                        <p class="justified-text">
                                            <%= content.value %>
                                        </p>
                                    <% } else if (content.type === 'photo') { %>
                                        <div class="spec-image">
                                            <img src="<%= content.image_path %>" 
                                                 alt="<%= list.title %> of <%= model.brand_name %> <%= model.model_name %>" 
                                                 class="w-full h-auto rounded-lg"
                                                 loading="lazy"
                                                 onload="this.classList.remove('loading')"
                                                 onerror="this.style.display='none'">
                                            <!-- Source for content image -->
                                            <% if (content.source) { %>
                                            <a href="<%= content.source.includes('http') ? content.source : 'https://' + content.source %>" 
                                               target="_blank" 
                                               rel="noopener noreferrer"
                                               class="image-source-badge"
                                               title="View source: <%= content.source %>">
                                                Source
                                            </a>
                                            <% } %>
                                        </div>
                                    <% } else if (content.type === 'link') { %>
                                        <a href="<%= content.value.startsWith('http') ? content.value : 'https://' + content.value %>" 
                                           target="_blank" 
                                           rel="noopener noreferrer"
                                           class="content-link">
                                            <%= content.value %>
                                        </a>
                                    <% } %>
                                </div>
                            <% }); %>
                        <% } else { %>
                            <p class="text-gray-400 text-center py-4">No content available for this specification.</p>
                        <% } %>
                    <% }); %>
                <% } else { %>
                    <p class="text-gray-400 text-center py-8">No specification lists available.</p>
                <% } %>
            </section>

            <!-- Action Buttons - Back to Model (Left) and Share (Right) -->
            <div class="action-buttons">
                <!-- Back to Model Button - Left Side -->
                <a href="/modeldetails/<%= model.id %>" class="back-to-model" aria-label="Back to model details">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M10 19l-7-7m0 0l7-7m-7 7h18"/>
                    </svg>
                    Back to Model
                </a>

                <!-- Enhanced Share Button - Right Side -->
                <button class="share-btn" onclick="openShareModal()" aria-label="Share this specification">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"/>
                    </svg>
                    Share
                </button>
            </div>
        </div>

        <!-- Right Side - Recommendations Sidebar -->
        <div class="recommendations-sidebar">
            
    <!-- Current Model Info -->
    <div class="mb-8">
        <h2 class="text-2xl font-bold text-white mb-6 relative pb-2">
            <%= model.brand_name %> <%= model.model_name %>
            <span class="absolute bottom-0 left-0 w-12 h-1 bg-gradient-to-r from-red-600 to-red-800 rounded-full"></span>
        </h2>
        <!-- MADE THE ENTIRE MODEL BOX CLICKABLE -->
        <a href="/modeldetails/<%= model.id %>" class="block">
            <div class="recommended-model-box mb-6 cursor-pointer transition-transform hover:scale-105">
                <div class="flex flex-row items-start p-2 rounded-xl">
                    <% if (model.model_image) { %>
                        <img src="<%= model.model_image %>" 
                             alt="<%= model.brand_name %> <%= model.model_name %>" 
                             class="w-24 h-24 bg-white rounded-lg flex-shrink-0 object-cover"
                             onload="this.classList.remove('loading')"
                             onerror="this.style.display='none'">
                    <% } else { %>
                        <div class="w-24 h-24 bg-gradient-to-br from-gray-700 to-gray-900 rounded-lg flex-shrink-0 flex items-center justify-center">
                            <svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"/>
                            </svg>
                        </div>
                    <% } %>
                    <div class="content ml-4 flex-grow text-white">
                        <div class="font-semibold text-lg mb-2 line-clamp-2">
                            <%= model.brand_name %> <%= model.model_name %>
                        </div>
                        <div class="text-sm text-gray-300 font-semibold">
                            <%= model.vehicle_type_name %>
                        </div>
                        <% if (model.starting_price) { %>
                        <div class="text-sm text-red-400 font-bold mt-1">
                            $<%= model.starting_price.toLocaleString() %>
                        </div>
                        <% } %>
                    </div>
                </div>
            </div>
        </a>
    </div>

            <!-- Other Specifications for Same Model -->
            <% if (otherSpecifications && otherSpecifications.length > 0) { %>
            <div class="mb-8">
                <h2 class="text-2xl font-bold text-white mb-6 relative pb-2">
                    Other Specifications
                    <span class="absolute bottom-0 left-0 w-12 h-1 bg-gradient-to-r from-red-600 to-red-800 rounded-full"></span>
                </h2>
                <div class="space-y-4">
                    <% otherSpecifications.forEach(otherSpec => { %>
                    <a href="/model/<%= encodeURIComponent(model.model_name) %>/<%= encodeURIComponent(otherSpec.title) %>" class="block">
                        <div class="spec-recommendation-box">
                            <div class="font-semibold text-white text-lg mb-1 line-clamp-2">
                                <%= otherSpec.title %>
                            </div>
                            <div class="text-sm text-gray-300">
                                <%= model.brand_name %> <%= model.model_name %>
                            </div>
                        </div>
                    </a>
                    <% }); %>
                </div>
            </div>
            <% } %>
        </div>
    </div>
</main>

<!-- Share Modal -->
<div id="shareModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 class="modal-title">Share This Specification</h3>
            <button class="close-btn" onclick="closeShareModal()" aria-label="Close share modal">&times;</button>
        </div>
        
        <div class="share-icons">
            <button class="share-icon" onclick="shareOnTwitter()" aria-label="Share on Twitter">
                <svg fill="currentColor" viewBox="0 0 24 24">
                    <path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"/>
                </svg>
            </button>
            
            <button class="share-icon" onclick="shareOnFacebook()" aria-label="Share on Facebook">
                <svg fill="currentColor" viewBox="0 0 24 24">
                    <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
                </svg>
            </button>
            
            <button class="share-icon" onclick="shareOnLinkedIn()" aria-label="Share on LinkedIn">
                <svg fill="currentColor" viewBox="0 0 24 24">
                    <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                </svg>
            </button>
            
            <button class="share-icon" onclick="shareOnWhatsApp()" aria-label="Share on WhatsApp">
                <svg fill="currentColor" viewBox="0 0 24 24">
                    <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893 0-3.176-1.24-6.165-3.495-8.411z"/>
                </svg>
            </button>
        </div>
        
        <button class="copy-link" onclick="copyToClipboard()" aria-label="Copy specification link to clipboard">
            <span>Copy Specification Link</span>
            <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>
            </svg>
        </button>
    </div>
</div>

<%- include('../partials/footer') %>

<script>
    // Modal Functions
    function openShareModal() {
        document.getElementById('shareModal').style.display = 'flex';
    }

    function closeShareModal() {
        document.getElementById('shareModal').style.display = 'none';
    }

    // Close modals when clicking outside
    window.onclick = function(event) {
        const shareModal = document.getElementById('shareModal');
        if (event.target === shareModal) {
            closeShareModal();
        }
    }

    // Social Share Functions
    function shareOnTwitter() {
        const url = encodeURIComponent('<%= currentUrl %>');
        const text = encodeURIComponent('<%= specification.title %> of <%= model.brand_name %> <%= model.model_name %> in Nepal');
        window.open(`https://twitter.com/intent/tweet?text=${text}&url=${url}`, '_blank');
        closeShareModal();
    }

    function shareOnFacebook() {
        const url = encodeURIComponent('<%= currentUrl %>');
        window.open(`https://www.facebook.com/sharer/sharer.php?u=${url}`, '_blank');
        closeShareModal();
    }

    function shareOnLinkedIn() {
        const url = encodeURIComponent('<%= currentUrl %>');
        window.open(`https://www.linkedin.com/sharing/share-offsite/?url=${url}`, '_blank');
        closeShareModal();
    }

    function shareOnWhatsApp() {
        const url = encodeURIComponent('<%= currentUrl %>');
        const text = encodeURIComponent('<%= specification.title %> of <%= model.brand_name %> <%= model.model_name %> in Nepal');
        window.open(`https://wa.me/?text=${text}%20${url}`, '_blank');
        closeShareModal();
    }

    function copyToClipboard() {
        const url = '<%= currentUrl %>';
        navigator.clipboard.writeText(url).then(() => {
            const btn = event.target;
            const originalText = btn.querySelector('span').textContent;
            btn.querySelector('span').textContent = 'Copied!';
            
            setTimeout(() => {
                btn.querySelector('span').textContent = originalText;
            }, 2000);
        });
    }

    // Mobile Menu Script
    const mobileMenuButton = document.getElementById('mobile-menu-button');
    const mobileMenuOverlay = document.getElementById('mobile-menu-overlay');
    const mobileMenuBackdrop = document.getElementById('mobile-menu-backdrop');
    const closeMobileMenuButton = document.getElementById('close-mobile-menu');

    const toggleMenu = () => {
        if (mobileMenuOverlay) mobileMenuOverlay.classList.toggle('mobile-menu-open');
        if (mobileMenuBackdrop) mobileMenuBackdrop.classList.toggle('active');
    };

    if (mobileMenuButton) mobileMenuButton.addEventListener('click', toggleMenu);
    if (closeMobileMenuButton) closeMobileMenuButton.addEventListener('click', toggleMenu);
    if (mobileMenuBackdrop) mobileMenuBackdrop.addEventListener('click', toggleMenu);

    // Highlight current page in navigation
    document.addEventListener('DOMContentLoaded', () => {
        const links = document.querySelectorAll('#desktop-nav-links a, .mobile-nav-link');
        links.forEach(link => {
            if (link.getAttribute('href') === '/modeldetails') {
                link.classList.add('bg-red-700');
            }
        });
        
        // Add loading class to images
        const images = document.querySelectorAll('img');
        images.forEach(img => {
            if (!img.complete) {
                img.classList.add('loading', 'loading-pulse');
            }
        });
    });
</script>
</body>
</html>